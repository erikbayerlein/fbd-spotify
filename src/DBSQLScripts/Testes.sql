-- teste Q5


-- teste Q6
Select * from dbo.Album_do_Comp ('Paul')
Select * from dbo.Obras_do_Compositor ('John')


-- teste 65 faixas 1 album
insert into faixa (id_faixa, id_album, id_tipo_comp, descricao, tempo_de_exec, pos_album, num_cd, num_vinil)
values
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 1, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Rockaway Beach', '00:02:30', 2, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Here Today, Gone Tomorrow', '00:02:30', 3, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Locket Love', '00:02:30', 4, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'I Don t Care live russia', '00:02:30', 5, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Sheena Is a Punk Rocker live russia', '00:02:30', 6, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'We re a Happy Family', '00:02:30', 7, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Teenage Lobotomy', '00:02:30', 8, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Do You Wanna Dance?', '00:02:30', 9, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 10, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 11, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 12, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 13, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 14, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 15, 1, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 16, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 17, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 18, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 19, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 20, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 21, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 22, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 23, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 24, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 25, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 26, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 27, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 28, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 29, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 30, 3, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 31, 3, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 32, 3, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 33, 3, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 34, 3, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 35, 3, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 36, 3, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 37, 3, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 38, 3, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 39, 3, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 40, 3, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 41, 4, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 42, 4, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 43, 4, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 44, 4, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 45, 4, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 46, 4, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 47, 4, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 48, 4, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 49, 4, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 50, 4, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 51, 5, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 52, 5, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 53, 5, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 54, 5, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 55, 5, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 56, 5, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 57, 5, null);
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 58, 5, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 59, 5, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 60, 5, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 61, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 62, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 63, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 64, 2, null),
(NEWID(), 'A7896E4D-293A-4601-A369-8B37EB553C24', 'B55D0B42-9155-11EE-B9D1-0242AC120002', 'Cretin Hop', '00:02:30', 65, 2, null);


-- Deletar album e faixas = Stored Procedure
EXEC DeleteAlbum @id_album = 'uuid'
---

-- insert album vinil com DDD
insert into album (id_album, id_grav, descricao, tipo_compra, preco, data_compra, data_gravacao, meio_fisico, tipo_grav_cd)
VALUES
    (NEWID(), 'B18B06FA-358E-459C-A7AD-E4C57824B2EF', 'Album Vinil com DDD', 'Credit card', 29.99, '2023-01-15', '2022-11-20', 'VINIL', 'DDD');

-- insert album vinil com ADD
insert into album (id_album, id_grav, descricao, tipo_compra, preco, data_compra, data_gravacao, meio_fisico, tipo_grav_cd)
VALUES
    (NEWID(), 'B18B06FA-358E-459C-A7AD-E4C57824B2EF', 'Album Vinil com DDD', 'Credit card', 29.99, '2023-01-15', '2022-11-20', 'VINIL', 'ADD');

-- insert album download ADD
insert into album (id_album, id_grav, descricao, tipo_compra, preco, data_compra, data_gravacao, meio_fisico, tipo_grav_cd)
VALUES
    (NEWID(), 'B18B06FA-358E-459C-A7AD-E4C57824B2EF', 'Album Vinil com DDD', 'Credit card', 29.99, '2023-01-15', '2022-11-20', 'Download', 'ADD');

-- downlaod com DDD

insert into album (id_album, id_grav, descricao, tipo_compra, preco, data_compra, data_gravacao, meio_fisico, tipo_grav_cd)
VALUES
    (NEWID(), 'B18B06FA-358E-459C-A7AD-E4C57824B2EF', 'Album Vinil com DDD', 'Credit card', 29.99, '2023-01-15', '2022-11-20', 'Download', 'DDD');

-----------------------------------------------
--teste para gatilho do preçco

INSERT INTO album (id_album, id_grav, descricao, tipo_compra, preco, data_compra, data_gravacao, meio_fisico, tipo_grav_cd)
VALUES
    (NEWID(), 'B18B06FA-358E-459C-A7AD-E4C57824B2EF', 'Album pra testar Preco', 'Credit card', 999.99, '2023-01-15', '2022-11-20', 'CD', 'DDD');



------------------------------------------
-----------
-- album para deletar e deletar faixas
insert into album (id_album, id_grav, descricao, tipo_compra, preco, data_compra, data_gravacao, meio_fisico, tipo_grav_cd)
VALUES
    (NEWID(), 'B18B06FA-358E-459C-A7AD-E4C57824B2EF', 'Album para deletar', 'Credit card', 29.99, '2023-01-15', '2022-11-20', 'VINIL', null);


INSERT INTO faixa (id_faixa, id_album, id_tipo_comp, descricao, tempo_de_exec, pos_album, num_cd, num_vinil)
VALUES
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDC1C-9155-11EE-B9D1-0242AC120002', 'Brandenburg Concerto No. 3 in G Major, BWV 1048', '00:05:38', 1, 1, null),
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDC1C-9155-11EE-B9D1-0242AC120002', 'Toccata and Fugue in D Minor, BWV 565', '00:12:38', 2, 1, null),
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDAB4-9155-11EE-B9D1-0242AC120002', 'Mass in B Minor, BWV 232', '00:08:38', 3, 1, null),
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDC1C-9155-11EE-B9D1-0242AC120002', 'Cello Suite No. 1 in G Major, BWV 1007', '00:15:38', 4, 1, null),
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDC1C-9155-11EE-B9D1-0242AC120002', 'St. Matthew Passion, BWV 244', '00:06:38', 5, 1, null);

---------------------------------------------------------
----------------------------------------------------------
select * from playlist pl
inner join faixa_playlist fpl on fpl.id_playlist = pl.id_playlist
inner join faixa f on f.id_faixa = fpl.id_faixa
inner join faixa_compositor fc on f.id_faixa = fc.id_faixa
inner join compositor c on c.id_compositor = fc.id_compositor
inner join tipo_composicao tc on tc.id_tipo_comp = f.id_tipo_comp 
inner join periodo_musical pm on pm.id_periodo_musical = c.id_periodo_musical
where pm.descricao like '%barroco%' and tc.descricao like '%concerto%'



--- instancias playlist - 7, item 3
INSERT INTO album (id_album, id_grav, descricao, tipo_compra, preco, data_compra, data_gravacao, meio_fisico, tipo_grav_cd)
VALUES
    (NEWID(), 'B18B06FA-358E-459C-A7AD-E4C57824B2EF', 'Baroque Brilliance: Bach s Masterpieces', 'Credit card', 29.99, '2023-01-15', '2022-11-20', 'CD', 'DDD');
-- FA45AAD9-7716-4C72-8CF0-4C308025C6BB
INSERT INTO faixa (id_faixa, id_album, id_tipo_comp, descricao, tempo_de_exec, pos_album, num_cd, num_vinil)
VALUES
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDC1C-9155-11EE-B9D1-0242AC120002', 'Brandenburg Concerto No. 3 in G Major, BWV 1048', '00:05:38', 1, 1, null),
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDC1C-9155-11EE-B9D1-0242AC120002', 'Toccata and Fugue in D Minor, BWV 565', '00:12:38', 2, 1, null),
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDAB4-9155-11EE-B9D1-0242AC120002', 'Mass in B Minor, BWV 232', '00:08:38', 3, 1, null),
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDC1C-9155-11EE-B9D1-0242AC120002', 'Cello Suite No. 1 in G Major, BWV 1007', '00:15:38', 4, 1, null),
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDC1C-9155-11EE-B9D1-0242AC120002', 'St. Matthew Passion, BWV 244', '00:06:38', 5, 1, null);

INSERT INTO faixa_compositor (id_faixa, id_compositor)
VALUES
    ('4DE4CA91-6D6D-4E70-89AB-BC2F9906F34D', '034A5935-F974-423D-B383-BD806FE9482B'),
    ('AA4E4769-D659-45E3-808C-8F463ECB2624', '034A5935-F974-423D-B383-BD806FE9482B'),
    ('36D867F0-740B-4E87-BC96-1DF6FFD43079', '034A5935-F974-423D-B383-BD806FE9482B'),
    ('8A3A451B-1126-4D33-8BE4-710A2BA3CAFB', '034A5935-F974-423D-B383-BD806FE9482B'),
    ('104B3D7F-3727-47BE-8263-CC058AF5032E', '034A5935-F974-423D-B383-BD806FE9482B');

insert into interprete (id_interprete, nome, tipo) values
(NEWID(), 'Sebá Bach rei do Barroco', 'Concerto')


insert into faixa_interprete (id_faixa, id_interprete)
values
    ('4DE4CA91-6D6D-4E70-89AB-BC2F9906F34D', 'C3B01FCF-97D8-44C4-97AC-9E7A233A8897'),
    ('AA4E4769-D659-45E3-808C-8F463ECB2624', 'C3B01FCF-97D8-44C4-97AC-9E7A233A8897'),
    ('36D867F0-740B-4E87-BC96-1DF6FFD43079', 'C3B01FCF-97D8-44C4-97AC-9E7A233A8897'),
    ('8A3A451B-1126-4D33-8BE4-710A2BA3CAFB', 'C3B01FCF-97D8-44C4-97AC-9E7A233A8897'),
    ('104B3D7F-3727-47BE-8263-CC058AF5032E', 'C3B01FCF-97D8-44C4-97AC-9E7A233A8897');


insert into playlist (id_playlist, nome, data_criacao, tempo_total_exec)
values
(newID(), 'Barroco em Concerto', getdate(), '00:00:00');
(newID(), 'Concerto com Barroco 2.0', getdate(), '00:00:00');


-- id das playlists
C82184EB-80C0-4AC3-AB6C-2D7EF2AFE641	Concerto com Barroco 2.0
insert into faixa_playlist (id_playlist, id_faixa)
values
('C82184EB-80C0-4AC3-AB6C-2D7EF2AFE641', '1C4FD1A8-915C-11EE-B9D1-0242AC120002'),
('C82184EB-80C0-4AC3-AB6C-2D7EF2AFE641', '4DE4CA91-6D6D-4E70-89AB-BC2F9906F34D'),
('C82184EB-80C0-4AC3-AB6C-2D7EF2AFE641', '3E4E1312-8E03-4A2B-BFFE-CB6F85800738');



63FFCD99-6882-4CB3-8A8B-FD242448C3B4    Barroco em concerto 
--barroco em concerto + bach
insert into faixa_playlist (id_playlist, id_faixa)
values
('63FFCD99-6882-4CB3-8A8B-FD242448C3B4', '4DE4CA91-6D6D-4E70-89AB-BC2F9906F34D'),
('63FFCD99-6882-4CB3-8A8B-FD242448C3B4', 'AA4E4769-D659-45E3-808C-8F463ECB2624'),
('63FFCD99-6882-4CB3-8A8B-FD242448C3B4', '8A3A451B-1126-4D33-8BE4-710A2BA3CAFB'),
('63FFCD99-6882-4CB3-8A8B-FD242448C3B4', '104B3D7F-3727-47BE-8263-CC058AF5032E');

-- faixas concerto
select * from faixa where id_tipo_comp= 'B55CDC1C-9155-11EE-B9D1-0242AC120002'

1C4FD1A8-915C-11EE-B9D1-0242AC120002    Heroic Symphony
CC9E29E5-ECA5-4C3F-81EC-3A2BB3EB4DBB    Jet
3E4E1312-8E03-4A2B-BFFE-CB6F85800738    Northern Nights
3E5FA1AA-617E-47F3-8CD1-E3566FE34263    Grandiose Gala
60A69269-A551-49A5-AD35-6BF0126FC14B    Stranger Than Fiction
4DE4CA91-6D6D-4E70-89AB-BC2F9906F34D    Brandenburg Concerto No. 3 in G Major, BWV 1048
AA4E4769-D659-45E3-808C-8F463ECB2624    Toccata and Fugue in D Minor, BWV 565
8A3A451B-1126-4D33-8BE4-710A2BA3CAFB    Cello Suite No. 1 in G Major, BWV 1007
104B3D7F-3727-47BE-8263-CC058AF5032E    St. Matthew Passion, BWV 244

-- faixas barroco
4DE4CA91-6D6D-4E70-89AB-BC2F9906F34D    Brandenburg Concerto No. 3 in G Major, BWV 1048
AA4E4769-D659-45E3-808C-8F463ECB2624    Toccata and Fugue in D Minor, BWV 565
8A3A451B-1126-4D33-8BE4-710A2BA3CAFB    Cello Suite No. 1 in G Major, BWV 1007
104B3D7F-3727-47BE-8263-CC058AF5032E    St. Matthew Passion, BWV 244
36D867F0-740B-4E87-BC96-1DF6FFD43079    Mass in B Minor, BWV 232 -- nao e concerto

-- faixas concerto e barroco
select * from faixa f
inner join faixa_compositor fc on f.id_faixa = fc.id_faixa
inner join compositor c on c.id_compositor = fc.id_compositor
inner join tipo_composicao tc on tc.id_tipo_comp = f.id_tipo_comp 
inner join periodo_musical pm on pm.id_periodo_musical = c.id_periodo_musical
where pm.descricao like '%barroco%' and tc.descricao like '%concerto%'



select * from faixa f
inner join faixa_compositor fc on f.id_faixa = fc.id_faixa
inner join compositor c on c.id_compositor = fc.id_compositor
inner join periodo_musical pm on c.id_periodo_musical = pm.id_periodo_musical
where pm.descricao like '%barroco%' 


select tc.descricao, f.descricao from tipo_composicao tc
inner join faixa f on f.id_tipo_comp = tc.id_tipo_comp
where tc.descricao like '%concerto%'
group by tc.descricao, f.descricao



select * from compositor where nome like '%bach%'

INSERT INTO faixa (id_faixa, id_album, id_tipo_comp, descricao, tempo_de_exec, pos_album, num_cd, num_vinil)
VALUES
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDC1C-9155-11EE-B9D1-0242AC120002', 'Brandenburg Concerto No. 3 in G Major, BWV 1048', '00:05:38', 1, 1, null),
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDC1C-9155-11EE-B9D1-0242AC120002', 'Toccata and Fugue in D Minor, BWV 565', '00:12:38', 2, 1, null),
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDAB4-9155-11EE-B9D1-0242AC120002', 'Mass in B Minor, BWV 232', '00:08:38', 3, 1, null),
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDC1C-9155-11EE-B9D1-0242AC120002', 'Cello Suite No. 1 in G Major, BWV 1007', '00:15:38', 4, 1, null),
(NEWID(), 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB', 'B55CDC1C-9155-11EE-B9D1-0242AC120002', 'St. Matthew Passion, BWV 244', '00:06:38', 5, 1, null);

select * from album where descricao = 'Baroque Brilliance: Bach s Masterpieces'

select * from faixa where id_album = 'FA45AAD9-7716-4C72-8CF0-4C308025C6BB'


INSERT INTO faixa_compositor (id_faixa, id_compositor)
VALUES
    ('4DE4CA91-6D6D-4E70-89AB-BC2F9906F34D', '034A5935-F974-423D-B383-BD806FE9482B'),
    ('AA4E4769-D659-45E3-808C-8F463ECB2624', '034A5935-F974-423D-B383-BD806FE9482B'),
    ('36D867F0-740B-4E87-BC96-1DF6FFD43079', '034A5935-F974-423D-B383-BD806FE9482B'),
    ('8A3A451B-1126-4D33-8BE4-710A2BA3CAFB', '034A5935-F974-423D-B383-BD806FE9482B'),
    ('104B3D7F-3727-47BE-8263-CC058AF5032E', '034A5935-F974-423D-B383-BD806FE9482B');


select * from faixa where id_tipo_comp= 'B55CDC1C-9155-11EE-B9D1-0242AC120002'



select * from tipo_composicao where descricao like  '%concerto%' -- B55CDC1C-9155-11EE-B9D1-0242AC120002

select * from faixa_interprete fi
inner join faixa f on f.id_faixa = fi.id_faixa
inner join interprete i on fi.id_interprete = i.id_interprete
where i.nome like '%bach%'

select * from interprete where nome like '%bach%' 


insert into faixa_playlist (id_playlist, id_faixa)
values
('C82184EB-80C0-4AC3-AB6C-2D7EF2AFE641', '1C4FD1A8-915C-11EE-B9D1-0242AC120002'),
('C82184EB-80C0-4AC3-AB6C-2D7EF2AFE641', '4DE4CA91-6D6D-4E70-89AB-BC2F9906F34D'),
('C82184EB-80C0-4AC3-AB6C-2D7EF2AFE641', '3E4E1312-8E03-4A2B-BFFE-CB6F85800738');



-- erik
SELECT pl.nome FROM playlist pl
INNER JOIN faixa_playlist fp ON pl.id_playlist = fp.id_playlist
INNER JOIN faixa f ON fp.id_faixa = f.id_faixa
INNER JOIN tipo_composicao tc ON f.id_tipo_comp = tc.id_tipo_comp
INNER JOIN faixa_compositor fc ON f.id_faixa = fc.id_faixa
INNER JOIN compositor compo ON fc.id_compositor = compo.id_compositor
INNER JOIN periodo_musical pm ON compo.id_periodo_musical = pm.id_periodo_musical
WHERE pm.descricao = 'Barroco' and tc.descricao = 'Concerto'

---------------------------
----------------------------
--------------------------
---------------------------
--testes para os gatilhos que funcionou

INSERT INTO album (id_album, id_grav, descricao, tipo_compra, preco, data_compra, data_gravacao, meio_fisico, tipo_grav_cd)
VALUES
    (NEWID(), 'B18B06FA-358E-459C-A7AD-E4C57824B2EF', 'Album de Teste para Barroco', 'Credit card', 29.99, '2023-01-15', '2022-11-20', 'CD', 'ADD');

select * from album where descricao like '%barroco%'


INSERT INTO faixa (id_faixa, id_album, id_tipo_comp, descricao, tempo_de_exec, pos_album, num_cd, num_vinil)
VALUES
(NEWID(), 'AF7FADDA-132F-4A89-B826-E8454B0AA168', 'B55DDA04-9155-11EE-B9D1-0242AC120002', 'Barroco 1', '00:05:38', 1, 1, null),
(NEWID(), 'AF7FADDA-132F-4A89-B826-E8454B0AA168', 'B55DDA04-9155-11EE-B9D1-0242AC120002', 'Barroco 2', '00:02:38', 2, 1, null);

select * from faixa where descricao like '%barroco%'


insert into faixa_compositor (id_faixa, id_compositor) values
('D36DEFE4-5BE3-4ED7-BBB2-02B3C7A35F69','034A5935-F974-423D-B383-BD806FE9482B'),
('863E570A-18C2-4047-BE9A-44F46D5F6427', '034A5935-F974-423D-B383-BD806FE9482B');









--========================================
--================================
select * from faixa_compositor fc
inner join compositor c on fc.id_compositor = c.id_compositor
inner join periodo_musical pm on pm.id_periodo_musical = c.id_periodo_musical
where pm.descricao like '%barroco%'

INSERT INTO album (id_album, id_grav, descricao, tipo_compra, preco, data_compra, data_gravacao, meio_fisico, tipo_grav_cd)
VALUES
    (NEWID(), 'B18B06FA-358E-459C-A7AD-E4C57824B2EF', 'Album de Teste para Barroco', 'Credit card', 29.99, '2023-01-15', '2022-11-20', 'CD', 'ADD');

select * from gravadora where nome like '%Bloco%'
select * from album where descricao like '%barroco%'

--faixas do album barroco teste
select * from faixa f
inner join album a on a.id_album = f.id_album
where a.id_album = '72B08613-86FC-43B0-AC97-01CFA6D281CB'

-- id Bloco dos ventos records : 'B18B06FA-358E-459C-A7AD-E4C57824B2EF'
-- id do album barroco pra testar: '72B08613-86FC-43B0-AC97-01CFA6D281CB'

INSERT INTO faixa (id_faixa, id_album, id_tipo_comp, descricao, tempo_de_exec, pos_album, num_cd, num_vinil)
VALUES
(NEWID(), '72B08613-86FC-43B0-AC97-01CFA6D281CB', 'B55DDA04-9155-11EE-B9D1-0242AC120002', 'Barroco 1', '00:05:38', 1, 1, null),
(NEWID(), '72B08613-86FC-43B0-AC97-01CFA6D281CB', 'B55DDA04-9155-11EE-B9D1-0242AC120002', 'Barroco 2', '00:02:38', 2, 1, null);

insert into faixa_compositor (id_faixa, id_compositor) values
('05E22CD5-5F8E-434C-A9E4-099A90FAACC5','034A5935-F974-423D-B383-BD806FE9482B'),
('9B3685B5-DABD-4B28-9063-9FE4DACB107F', '034A5935-F974-423D-B383-BD806FE9482B');

select * from faixa where descricao like '%barroco%'

delete from faixa
where id_faixa='E59E7F38-1579-4EB0-86BA-D6D913F293A8' or id_faixa='651CAE0F-33A8-4F95-A38C-F529969A6958'

Select * from dbo.Obras_do_Compositor ('Dvorack')

------

CREATE PROCEDURE DeleteFaixaBarroca @id_faixa uniqueidentifier
AS
BEGIN
 DELETE FROM faixa WHERE id_faixa=@id_faixa
END




-----------

CREATE TRIGGER trg_barrocoTres
ON faixa_compositor
INSTEAD OF INSERT
AS
BEGIN
  SET NOCOUNT ON;

  IF EXISTS (
    SELECT 1
    FROM inserted i
    JOIN faixa f ON i.id_faixa = f.id_faixa
    JOIN album a ON f.id_album = a.id_album AND (a.tipo_grav_cd = 'ADD' OR a.meio_fisico = 'vinil' OR a.meio_fisico = 'download')
    JOIN compositor c ON c.id_compositor = i.id_compositor
    JOIN periodo_musical pm ON pm.id_periodo_musical = c.id_periodo_musical AND pm.descricao = 'Barroco'
  )
  BEGIN
    DECLARE @id_deletar UNIQUEIDENTIFIER;
    SELECT TOP 1 @id_deletar = a.id_album
    FROM inserted i
    JOIN faixa f ON i.id_faixa = f.id_faixa
    JOIN album a ON a.id_album = f.id_album;

    EXEC DeleteAlbum @id_album = @id_deletar;

    -- Display the error message
    RAISERROR ('Erro: Se a composicao eh do estilo Barroco, a gravacao precisa ser em cd DDD. A insercao nao foi realizada e o album informado foi excluido junto com as faixas nao autorizadas', 16, 1);

    RETURN; -- Exit the trigger
  END
  ELSE
  BEGIN
    INSERT INTO faixa_compositor
    SELECT * FROM inserted;
  END;
END;




------------

CREATE TRIGGER trg_barrocoDois
ON faixa_compositor
INSTEAD OF INSERT
AS
BEGIN
  SET NOCOUNT ON;

  IF EXISTS (
    SELECT 1
    FROM inserted i
    JOIN faixa f ON i.id_faixa = f.id_faixa
    JOIN album a ON f.id_album = a.id_album AND (a.tipo_grav_cd = 'ADD' OR a.meio_fisico = 'vinil' OR a.meio_fisico = 'download')
    JOIN compositor c ON c.id_compositor = i.id_compositor
    JOIN periodo_musical pm ON pm.id_periodo_musical = c.id_periodo_musical AND pm.descricao = 'Barroco'
  )
  BEGIN
    DECLARE @id_deletar UNIQUEIDENTIFIER;
    SELECT @id_deletar = (SELECT a.id_album FROM inserted i JOIN faixa f ON i.id_faixa = f.id_faixa JOIN album a ON a.id_album = f.id_album);
    EXEC DeleteAlbum @id_album = @id_deletar;

    RETURN;
  END
  ELSE
  BEGIN
    INSERT INTO faixa_compositor
    SELECT * FROM inserted;
  END;
END;




--------

CREATE TRIGGER trg_barroco
ON faixa_compositor
INSTEAD OF INSERT
AS
BEGIN
 SET NOCOUNT ON;
 IF EXISTS (
   SELECT 1
   FROM inserted i
   JOIN faixa f ON i.id_faixa = f.id_faixa
   JOIN album a ON f.id_album = a.id_album AND (a.tipo_grav_cd = 'ADD' OR a.meio_fisico = 'vinil' OR a.meio_fisico = 'download')
   JOIN compositor c ON c.id_compositor = i.id_compositor
   JOIN periodo_musical pm ON pm.id_periodo_musical = c.id_periodo_musical AND pm.descricao = 'Barroco'
 )
 BEGIN
   EXEC DeleteFaixaBarroca (SELECT id_faixa FROM inserted);
   RAISERROR ('Erro: Se a composicao eh do estilo Barroco, a gravacao precisa ser em cd DDD', 16, 1);

   ROLLBACK TRANSACTION;
   RETURN;
 END;
 ELSE
 BEGIN
   INSERT INTO faixa_compositor
   SELECT * FROM inserted;
 END;
END;



















-------

CREATE TRIGGER trg_barroco
ON faixa_compositor
INSTEAD OF INSERT
AS
BEGIN
 DECLARE @tab_aux TABLE (id_faixa uniqueidentifier);
 INSERT INTO @tab_aux
 SELECT * FROM inserted;

 SET NOCOUNT ON;
 IF EXISTS (
 SELECT 1
 FROM inserted i
 JOIN faixa f ON i.id_faixa = f.id_faixa
 JOIN album a ON f.id_album = a.id_album AND (a.tipo_grav_cd = 'ADD' OR a.meio_fisico = 'vinil' OR a.meio_fisico = 'download')
 JOIN compositor c ON c.id_compositor = i.id_compositor
 JOIN periodo_musical pm ON pm.id_periodo_musical = c.id_periodo_musical AND pm.descricao = 'Barroco'
 )
 BEGIN
 RAISERROR ('Erro: Se a composicao eh do estilo Barroco, a gravacao precisa ser em cd DDD', 16, 1);
 
 DELETE FROM faixa
 WHERE id_faixa IN (SELECT id_faixa FROM inserted);

 ROLLBACK TRANSACTION;
 RETURN;
 END;
 ELSE
 BEGIN
 INSERT INTO faixa_compositor


 SELECT * FROM inserted;
 END;
END;

select * from periodo_musical where descricao like '%barroco%'

select * from compositor where nome like'%barroco%'

SELECT *
  FROM faixa i 
  JOIN album a ON i.id_album = a.id_album AND (a.tipo_grav_cd = 'ADD' OR a.meio_fisico = 'vinil' OR a.meio_fisico = 'download')
  JOIN faixa_compositor fc ON fc.id_faixa = i.id_faixa
  JOIN compositor c ON c.id_compositor = fc.id_compositor
  JOIN periodo_musical pm ON pm.id_periodo_musical = c.id_periodo_musical AND pm.descricao = 'Barroco'


 




-----------------
---- trg novo
----------

CREATE TRIGGER trg_barroco
ON faixa_compositor
INSTEAD OF INSERT
AS
BEGIN
 SET NOCOUNT ON;
 DECLARE @tab_aux TABLE (id_faixa uniqueidentifier);

 INSERT INTO @tab_aux
 SELECT id_faixa FROM inserted;

 IF EXISTS (
   SELECT 1
   FROM @tab_aux t
   JOIN faixa f ON t.id_faixa = f.id_faixa
   JOIN album a ON f.id_album = a.id_album AND (a.tipo_grav_cd = 'ADD' OR a.meio_fisico = 'vinil' OR a.meio_fisico = 'download')
   JOIN faixa_compositor fc on fc.id_faixa = f.id_faixa
   JOIN compositor c ON c.id_compositor = fc.id_compositor
   JOIN periodo_musical pm ON pm.id_periodo_musical = c.id_periodo_musical AND pm.descricao = 'Barroco'
 )
 BEGIN
   DELETE FROM faixa
   WHERE id_faixa IN (SELECT id_faixa FROM @tab_aux);

   RAISERROR ('Erro: Se a composicao eh do estilo Barroco, a gravacao precisa ser em cd DDD', 16, 1);
   ROLLBACK TRANSACTION;
   RETURN;
 END;
 ELSE
 BEGIN
   INSERT INTO faixa_compositor
   SELECT * FROM inserted;
 END;
END;